# WordPress Cache Analysis Signatures
# Comprehensive fingerprints for cache plugins, CDNs, WAFs, and server features

plugins:
  # PAGE CACHE PLUGINS
  wp-rocket:
    name: "WP Rocket"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- This website is like a rocket"
        - "<!-- Cached by WP Rocket"
        - "<!-- wprocket"
      headers:
        - "X-WP-Rocket"
      cookies:
        - "rocket_cache_active"
      paths:
        - "/wp-content/cache/wp-rocket/"
        - "/wp-content/plugins/wp-rocket/"

  w3-total-cache:
    name: "W3 Total Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Performance optimized by W3 Total Cache"
        - "<!-- W3TC"
        - "<!-- Served from: "
      headers:
        - "X-W3TC"
        - "X-W3TC-Minify"
      paths:
        - "/wp-content/cache/page_enhanced/"
        - "/wp-content/plugins/w3-total-cache/"

  wp-super-cache:
    name: "WP Super Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Cached page generated by WP-Super-Cache"
        - "<!-- super cache"
        - "<!-- Dynamic page generated"
        - "<!-- WP Super Cache"
      paths:
        - "/wp-content/cache/supercache/"
        - "/wp-content/plugins/wp-super-cache/"

  litespeed-cache:
    name: "LiteSpeed Cache"
    category: "page-cache"
    # Note: Headers like X-LiteSpeed-Cache are NOT used for plugin detection
    # because LiteSpeed Server sends these natively without the WP plugin.
    # Server-level caching is detected separately in server_cache section.
    signatures:
      html_comments:
        - "<!-- Page generated by LiteSpeed Cache"
        - "<!-- LiteSpeed Cache"
      paths:
        - "/wp-content/litespeed/"
        - "/wp-content/plugins/litespeed-cache/"

  wp-fastest-cache:
    name: "WP Fastest Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- WP Fastest Cache"
      paths:
        - "/wp-content/cache/all/"
        - "/wp-content/plugins/wp-fastest-cache/"

  breeze:
    name: "Breeze"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Cache served by Breeze"
      paths:
        - "/wp-content/cache/breeze/"
        - "/wp-content/plugins/breeze/"

  cache-enabler:
    name: "Cache Enabler"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Cache Enabler by KeyCDN"
        - "<!-- Cache Enabler"
      paths:
        - "/wp-content/cache/cache-enabler/"
        - "/wp-content/plugins/cache-enabler/"

  comet-cache:
    name: "Comet Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Comet Cache"
        - "<!-- ZenCache"
      paths:
        - "/wp-content/cache/comet-cache/"
        - "/wp-content/plugins/comet-cache/"

  swift-performance:
    name: "Swift Performance"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Swift Performance"
      headers:
        - "X-Swift-Cache"
      paths:
        - "/wp-content/cache/swift-performance/"
        - "/wp-content/plugins/swift-performance/"
        - "/wp-content/plugins/swift-performance-lite/"

  hummingbird:
    name: "Hummingbird"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Hummingbird"
      paths:
        - "/wp-content/cache/hummingbird/"
        - "/wp-content/plugins/hummingbird-performance/"

  flying-press:
    name: "FlyingPress"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Optimized by FlyingPress"
        - "<!-- FlyingPress"
      headers:
        - "X-FlyingPress"
        - "X-FlyingPress-Cache"
      paths:
        - "/wp-content/plugins/flying-press/"

  sg-optimizer:
    name: "SG Optimizer"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- SG Optimizer"
        - "<!-- This website is optimized by SG Optimizer"
      paths:
        - "/wp-content/cache/flavor/"
        - "/wp-content/plugins/sg-cachepress/"

  powered-cache:
    name: "Powered Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Powered Cache"
      paths:
        - "/wp-content/cache/powered-cache/"
        - "/wp-content/plugins/powered-cache/"

  hyper-cache:
    name: "Hyper Cache"
    category: "page-cache"
    signatures:
      paths:
        - "/wp-content/cache/hyper-cache/"
        - "/wp-content/plugins/hyper-cache/"

  simple-cache:
    name: "Simple Cache"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- Simple Cache"
      paths:
        - "/wp-content/cache/simple-cache/"
        - "/wp-content/plugins/simple-cache/"

  nitropack:
    name: "NitroPack"
    category: "page-cache"
    signatures:
      headers:
        - "X-Nitro-Cache"
        - "X-NitroPack-Cache"
      html_comments:
        - "<!-- NitroPack"
      paths:
        - "/wp-content/plugins/nitropack/"

  wp-optimize:
    name: "WP-Optimize"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- WP-Optimize"
      paths:
        - "/wp-content/cache/wpo-cache/"
        - "/wp-content/plugins/wp-optimize/"

  starter-cache:
    name: "10Web Booster"
    category: "page-cache"
    signatures:
      html_comments:
        - "<!-- 10Web Booster"
      paths:
        - "/wp-content/plugins/starter-cache/"


  # OBJECT CACHE PLUGINS
  redis-cache:
    name: "Redis Object Cache"
    category: "object-cache"
    signatures:
      html_comments:
        - "<!-- Redis Object Cache"
      paths:
        - "/wp-content/object-cache.php"
        - "/wp-content/plugins/redis-cache/"

  object-cache-pro:
    name: "Object Cache Pro"
    category: "object-cache"
    signatures:
      html_comments:
        - "<!-- Object Cache Pro"
      paths:
        - "/wp-content/plugins/object-cache-pro/"

  memcached:
    name: "Memcached Object Cache"
    category: "object-cache"
    signatures:
      paths:
        - "/wp-content/object-cache.php"
        - "/wp-content/plugins/memcached/"

  w3tc-memcached:
    name: "W3TC Memcached"
    category: "object-cache"
    signatures:
      headers:
        - "X-W3TC-Memcached"

  docket-cache:
    name: "Docket Cache"
    category: "object-cache"
    signatures:
      html_comments:
        - "<!-- Starter cache by Docket Cache"
      paths:
        - "/wp-content/plugins/docket-cache/"

  # OPTIMIZATION PLUGINS
  autoptimize:
    name: "Autoptimize"
    category: "optimization"
    signatures:
      html_comments:
        - "<!-- Autoptimize"
      paths:
        - "/wp-content/cache/autoptimize/"
        - "/wp-content/plugins/autoptimize/"

  perfmatters:
    name: "Perfmatters"
    category: "optimization"
    signatures:
      paths:
        - "/wp-content/plugins/perfmatters/"

  asset-cleanup:
    name: "Asset CleanUp"
    category: "optimization"
    signatures:
      html_comments:
        - "<!-- Asset CleanUp"
      paths:
        - "/wp-content/plugins/wp-asset-clean-up/"

  flying-scripts:
    name: "Flying Scripts"
    category: "optimization"
    signatures:
      paths:
        - "/wp-content/plugins/flying-scripts/"

  # IMAGE OPTIMIZATION
  imagify:
    name: "Imagify"
    category: "image-optimization"
    signatures:
      paths:
        - "/wp-content/plugins/imagify/"

  smush:
    name: "Smush"
    category: "image-optimization"
    signatures:
      paths:
        - "/wp-content/plugins/wp-smush/"
        - "/wp-content/plugins/wp-smush-pro/"

  shortpixel:
    name: "ShortPixel"
    category: "image-optimization"
    signatures:
      paths:
        - "/wp-content/plugins/shortpixel-image-optimiser/"

  ewww:
    name: "EWWW Image Optimizer"
    category: "image-optimization"
    signatures:
      paths:
        - "/wp-content/plugins/ewww-image-optimizer/"

  optimole:
    name: "Optimole"
    category: "image-optimization"
    signatures:
      paths:
        - "/wp-content/plugins/optimole-wp/"

# CDN PROVIDERS
cdns:
  cloudflare:
    name: "Cloudflare"
    signatures:
      headers:
        - "CF-Cache-Status"
        - "CF-Ray"
      server: "cloudflare"

  cloudflare-apo:
    name: "Cloudflare APO"
    signatures:
      headers:
        - "cf-apo-via"
        - "cf-edge-cache"

  fastly:
    name: "Fastly"
    signatures:
      headers:
        - "X-Fastly-Request-ID"
        - "X-Served-By"
      via: "varnish"

  keycdn:
    name: "KeyCDN"
    signatures:
      headers:
        - "X-Edge-Location"
      server: "keycdn"

  bunnycdn:
    name: "BunnyCDN"
    signatures:
      headers:
        - "CDN-PullZone"
        - "CDN-Uid"
      server: "BunnyCDN"

  stackpath:
    name: "StackPath"
    signatures:
      headers:
        - "X-HW"
      server: "NetDNA"

  sucuri:
    name: "Sucuri"
    signatures:
      headers:
        - "X-Sucuri-ID"
        - "X-Sucuri-Cache"
      server: "Sucuri"

  cloudfront:
    name: "CloudFront"
    signatures:
      headers:
        - "X-Amz-Cf-Id"
        - "X-Amz-Cf-Pop"
      via: "CloudFront"

  akamai:
    name: "Akamai"
    signatures:
      headers:
        - "X-Akamai-Request-ID"
      server: "AkamaiGHost"

  imperva:
    name: "Imperva"
    signatures:
      headers:
        - "X-Iinfo"
      server: "Incapsula"

  quic-cloud:
    name: "QUIC.cloud"
    signatures:
      headers:
        - "X-QC-Cache"

  ezoic:
    name: "Ezoic"
    signatures:
      headers:
        - "X-Ezoic-CDN"
      server: "ezoic"

  azure-cdn:
    name: "Azure CDN"
    signatures:
      headers:
        - "X-Azure-Ref"

  google-cdn:
    name: "Google CDN"
    signatures:
      server: "Google Frontend"

# SERVER CACHING
server_cache:
  varnish:
    name: "Varnish"
    signatures:
      headers:
        - "X-Varnish"
      via: "varnish"

  nginx-fastcgi:
    name: "Nginx FastCGI"
    signatures:
      headers:
        - "X-FastCGI-Cache"
        - "X-Nginx-Cache"

  litespeed-server:
    name: "LiteSpeed Server"
    signatures:
      headers:
        - "X-LiteSpeed-Cache"
      server: "LiteSpeed"

  wpengine:
    name: "WP Engine"
    signatures:
      headers:
        - "X-WPE-Cached"

  kinsta:
    name: "Kinsta"
    signatures:
      headers:
        - "X-Kinsta-Cache"

  siteground:
    name: "SiteGround"
    signatures:
      headers:
        - "X-SG-Cache"

  pantheon:
    name: "Pantheon"
    signatures:
      headers:
        - "X-Pantheon-Styx-Hostname"

  flywheel:
    name: "Flywheel"
    signatures:
      headers:
        - "X-FW-Cache"

# CACHE STATUS VALUES
cache_status:
  hit_values:
    - "HIT"
    - "TCP_HIT"
    - "MEM_HIT"
    - "REVALIDATED"
  miss_values:
    - "MISS"
    - "TCP_MISS"
    - "DYNAMIC"
    - "BYPASS"
    - "EXPIRED"
  stale_values:
    - "STALE"
    - "UPDATING"

# CONFLICTS
conflicts:
  - plugins: ["wp-rocket", "w3-total-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-rocket", "wp-super-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-rocket", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-rocket", "wp-fastest-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-rocket", "swift-performance"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["w3-total-cache", "wp-super-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["w3-total-cache", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["litespeed-cache", "wp-fastest-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["breeze", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["sg-optimizer", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["nitropack", "wp-rocket"]
    severity: "high"
    reason: "NitroPack includes caching"

  - plugins: ["wp-rocket", "autoptimize"]
    severity: "medium"
    reason: "Both can minify CSS/JS"

  - plugins: ["w3-total-cache", "autoptimize"]
    severity: "medium"
    reason: "Both can minify CSS/JS"

  - plugins: ["litespeed-cache", "autoptimize"]
    severity: "medium"
    reason: "Both can minify CSS/JS"

  - plugins: ["redis-cache", "object-cache-pro"]
    severity: "high"
    reason: "Both provide object caching"

  - plugins: ["redis-cache", "memcached"]
    severity: "high"
    reason: "Both provide object caching"

  - plugins: ["memcached", "object-cache-pro"]
    severity: "high"
    reason: "Both provide object caching"

  - plugins: ["redis-cache", "docket-cache"]
    severity: "high"
    reason: "Both provide object caching"

  - plugins: ["imagify", "smush"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["imagify", "shortpixel"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["smush", "ewww"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["smush", "shortpixel"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["ewww", "shortpixel"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["imagify", "ewww"]
    severity: "medium"
    reason: "Both optimize images"

  - plugins: ["optimole", "imagify"]
    severity: "medium"
    reason: "Both optimize and serve images"

  - plugins: ["optimole", "smush"]
    severity: "medium"
    reason: "Both optimize images"

  # Additional page cache conflicts
  - plugins: ["hummingbird", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["hummingbird", "w3-total-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["hummingbird", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["flying-press", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching and optimization"

  - plugins: ["flying-press", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-optimize", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["wp-optimize", "w3-total-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["powered-cache", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["cache-enabler", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["cache-enabler", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["comet-cache", "wp-rocket"]
    severity: "high"
    reason: "Both provide page caching"

  - plugins: ["comet-cache", "w3-total-cache"]
    severity: "high"
    reason: "Both provide page caching"

  # SEO plugin conflicts
  - plugins: ["wordpress-seo", "all-in-one-seo-pack"]
    severity: "high"
    reason: "Both manage SEO meta tags and sitemaps"

  - plugins: ["wordpress-seo", "seo-by-rank-math"]
    severity: "high"
    reason: "Both manage SEO meta tags and sitemaps"

  - plugins: ["wordpress-seo", "autodescription"]
    severity: "high"
    reason: "Both manage SEO meta tags"

  - plugins: ["all-in-one-seo-pack", "seo-by-rank-math"]
    severity: "high"
    reason: "Both manage SEO meta tags and sitemaps"

  - plugins: ["seo-by-rank-math", "autodescription"]
    severity: "high"
    reason: "Both manage SEO meta tags"

  # Security plugin conflicts
  - plugins: ["wordfence", "better-wp-security"]
    severity: "medium"
    reason: "Both provide firewall and login security - may conflict"

  - plugins: ["wordfence", "sucuri-scanner"]
    severity: "medium"
    reason: "Both provide firewall and malware scanning"

  - plugins: ["wordfence", "defender-security"]
    severity: "medium"
    reason: "Both provide security features that may overlap"

  - plugins: ["better-wp-security", "sucuri-scanner"]
    severity: "medium"
    reason: "Both provide security hardening features"

  # Optimization/minification conflicts
  - plugins: ["perfmatters", "autoptimize"]
    severity: "medium"
    reason: "Both can delay/defer JavaScript loading"

  - plugins: ["perfmatters", "wp-rocket"]
    severity: "low"
    reason: "Overlapping script delay features - configure carefully"

  - plugins: ["flying-scripts", "wp-rocket"]
    severity: "low"
    reason: "Both can delay JavaScript - may conflict"

  - plugins: ["flying-scripts", "perfmatters"]
    severity: "medium"
    reason: "Both delay JavaScript loading"

  - plugins: ["asset-cleanup", "perfmatters"]
    severity: "medium"
    reason: "Both manage script/style loading"

  - plugins: ["asset-cleanup", "wp-rocket"]
    severity: "low"
    reason: "Both can remove unused CSS/JS"

  - plugins: ["swift-performance", "autoptimize"]
    severity: "medium"
    reason: "Both minify CSS/JS"

  - plugins: ["hummingbird", "autoptimize"]
    severity: "medium"
    reason: "Both minify CSS/JS"

  - plugins: ["wp-fastest-cache", "autoptimize"]
    severity: "medium"
    reason: "Both can minify CSS/JS"

  - plugins: ["nitropack", "autoptimize"]
    severity: "high"
    reason: "NitroPack handles all optimization - Autoptimize not needed"

  - plugins: ["nitropack", "perfmatters"]
    severity: "medium"
    reason: "NitroPack handles script optimization"

  - plugins: ["nitropack", "flying-scripts"]
    severity: "medium"
    reason: "NitroPack handles script delay"

  # Lazy loading conflicts
  - plugins: ["wp-rocket", "a3-lazy-load"]
    severity: "medium"
    reason: "Both provide lazy loading for images"

  - plugins: ["litespeed-cache", "a3-lazy-load"]
    severity: "medium"
    reason: "Both provide lazy loading"

  - plugins: ["smush", "a3-lazy-load"]
    severity: "medium"
    reason: "Both provide lazy loading for images"

  # Hosting-specific conflicts
  - plugins: ["sg-optimizer", "w3-total-cache"]
    severity: "high"
    reason: "SiteGround's cache conflicts with W3TC"

  - plugins: ["sg-optimizer", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching - use SG Optimizer on SiteGround"

  - plugins: ["sg-optimizer", "wp-super-cache"]
    severity: "high"
    reason: "SiteGround's cache conflicts with WP Super Cache"

  - plugins: ["breeze", "w3-total-cache"]
    severity: "high"
    reason: "Cloudways Breeze conflicts with W3TC"

  - plugins: ["breeze", "litespeed-cache"]
    severity: "high"
    reason: "Both provide page caching"
